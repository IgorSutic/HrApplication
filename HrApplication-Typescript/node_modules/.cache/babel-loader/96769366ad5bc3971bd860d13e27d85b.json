{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/scheduler/appointments/appointment.js)\r\n * Version: 21.1.6\r\n * Build date: Mon Sep 27 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../../core/renderer\";\nimport eventsEngine from \"../../../events/core/events_engine\";\nimport { move } from \"../../../animation/translator\";\nimport { getRecurrenceProcessor } from \"../recurrence\";\nimport { extend } from \"../../../core/utils/extend\";\nimport registerComponent from \"../../../core/component_registrator\";\nimport { hide, show } from \"../../tooltip/ui.tooltip\";\nimport { addNamespace } from \"../../../events/utils/index\";\nimport pointerEvents from \"../../../events/pointer\";\nimport DOMComponent from \"../../../core/dom_component\";\nimport Resizable from \"../../resizable\";\nimport messageLocalization from \"../../../localization/message\";\nimport dateLocalization from \"../../../localization/date\";\nimport { EMPTY_APPOINTMENT_CLASS, RECURRENCE_APPOINTMENT_CLASS, REDUCED_APPOINTMENT_CLASS, ALL_DAY_APPOINTMENT_CLASS, REDUCED_APPOINTMENT_ICON, REDUCED_APPOINTMENT_PARTS_CLASSES, DIRECTION_APPOINTMENT_CLASSES, APPOINTMENT_DRAG_SOURCE_CLASS, APPOINTMENT_CONTENT_CLASSES } from \"../constants\";\nimport { Deferred } from \"../../../core/utils/deferred\";\nvar DEFAULT_HORIZONTAL_HANDLES = \"left right\";\nvar DEFAULT_VERTICAL_HANDLES = \"top bottom\";\nvar REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME = addNamespace(pointerEvents.enter, \"dxSchedulerAppointment\");\nvar REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME = addNamespace(pointerEvents.leave, \"dxSchedulerAppointment\");\nexport class Appointment extends DOMComponent {\n  get coloredElement() {\n    return this.$element();\n  }\n\n  get rawAppointment() {\n    return this.option(\"data\");\n  }\n\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      data: {},\n      groupIndex: -1,\n      geometry: {\n        top: 0,\n        left: 0,\n        width: 0,\n        height: 0\n      },\n      allowDrag: true,\n      allowResize: true,\n      reduced: null,\n      isCompact: false,\n      direction: \"vertical\",\n      resizableConfig: {},\n      cellHeight: 0,\n      cellWidth: 0,\n      isDragSource: false\n    });\n  }\n\n  notifyObserver(subject, args) {\n    var observer = this.option(\"observer\");\n\n    if (observer) {\n      observer.fire(subject, args);\n    }\n  }\n\n  invoke() {\n    var observer = this.option(\"observer\");\n\n    if (observer) {\n      return observer.fire.apply(observer, arguments);\n    }\n  }\n\n  _optionChanged(args) {\n    switch (args.name) {\n      case \"data\":\n      case \"groupIndex\":\n      case \"geometry\":\n      case \"allowDrag\":\n      case \"allowResize\":\n      case \"reduced\":\n      case \"sortedIndex\":\n      case \"isCompact\":\n      case \"direction\":\n      case \"resizableConfig\":\n      case \"cellHeight\":\n      case \"cellWidth\":\n        this._invalidate();\n\n        break;\n\n      case \"isDragSource\":\n        this._renderDragSourceClass();\n\n        break;\n\n      default:\n        super._optionChanged(args);\n\n    }\n  }\n\n  _getHorizontalResizingRule() {\n    var reducedHandles = {\n      head: this.option(\"rtlEnabled\") ? \"right\" : \"left\",\n      body: \"\",\n      tail: this.option(\"rtlEnabled\") ? \"left\" : \"right\"\n    };\n    return {\n      handles: this.option(\"reduced\") ? reducedHandles[this.option(\"reduced\")] : DEFAULT_HORIZONTAL_HANDLES,\n      minHeight: 0,\n      minWidth: this.invoke(\"getCellWidth\"),\n      step: this.invoke(\"getResizableStep\"),\n      roundStepValue: false\n    };\n  }\n\n  _getVerticalResizingRule() {\n    var height = this.invoke(\"getCellHeight\");\n    return {\n      handles: DEFAULT_VERTICAL_HANDLES,\n      minWidth: 0,\n      minHeight: height,\n      step: height,\n      roundStepValue: true\n    };\n  }\n\n  _render() {\n    super._render();\n\n    this._renderAppointmentGeometry();\n\n    this._renderEmptyClass();\n\n    this._renderReducedAppointment();\n\n    this._renderAllDayClass();\n\n    this._renderDragSourceClass();\n\n    this._renderDirection();\n\n    this.$element().data(\"dxAppointmentStartDate\", this.option(\"startDate\"));\n    this.$element().attr(\"title\", this.invoke(\"getField\", \"text\", this.rawAppointment));\n    this.$element().attr(\"role\", \"button\");\n\n    this._renderRecurrenceClass();\n\n    this._renderResizable();\n\n    this._setResourceColor();\n  }\n\n  _setResourceColor() {\n    var deferredColor = this.invoke(\"getAppointmentColor\", {\n      itemData: this.rawAppointment,\n      groupIndex: this.option(\"groupIndex\")\n    });\n    deferredColor.done(color => color && this.coloredElement.css(\"backgroundColor\", color));\n  }\n\n  _renderAppointmentGeometry() {\n    var geometry = this.option(\"geometry\");\n    var $element = this.$element();\n    move($element, {\n      top: geometry.top,\n      left: geometry.left\n    });\n    $element.css({\n      width: geometry.width < 0 ? 0 : geometry.width,\n      height: geometry.height < 0 ? 0 : geometry.height\n    });\n  }\n\n  _renderEmptyClass() {\n    var geometry = this.option(\"geometry\");\n\n    if (geometry.empty || this.option(\"isCompact\")) {\n      this.$element().addClass(EMPTY_APPOINTMENT_CLASS);\n    }\n  }\n\n  _renderReducedAppointment() {\n    var reducedPart = this.option(\"reduced\");\n\n    if (!reducedPart) {\n      return;\n    }\n\n    this.$element().toggleClass(REDUCED_APPOINTMENT_CLASS, true).toggleClass(REDUCED_APPOINTMENT_PARTS_CLASSES[reducedPart], true);\n\n    this._renderAppointmentReducedIcon();\n  }\n\n  _renderAppointmentReducedIcon() {\n    var $icon = $(\"<div>\").addClass(REDUCED_APPOINTMENT_ICON).appendTo(this.$element());\n\n    var endDate = this._getEndDate();\n\n    var tooltipLabel = messageLocalization.format(\"dxScheduler-editorLabelEndDate\");\n    var tooltipText = [tooltipLabel, \": \", dateLocalization.format(endDate, \"monthAndDay\"), \", \", dateLocalization.format(endDate, \"year\")].join(\"\");\n    eventsEngine.off($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME);\n    eventsEngine.on($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME, function () {\n      show({\n        target: $icon,\n        content: tooltipText\n      });\n    });\n    eventsEngine.off($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME);\n    eventsEngine.on($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME, function () {\n      hide();\n    });\n  }\n\n  _getEndDate() {\n    var result = this.invoke(\"getField\", \"endDate\", this.rawAppointment);\n\n    if (result) {\n      return new Date(result);\n    }\n\n    return result;\n  }\n\n  _renderAllDayClass() {\n    this.$element().toggleClass(ALL_DAY_APPOINTMENT_CLASS, !!this.option(\"allDay\"));\n  }\n\n  _renderDragSourceClass() {\n    this.$element().toggleClass(APPOINTMENT_DRAG_SOURCE_CLASS, !!this.option(\"isDragSource\"));\n  }\n\n  _renderRecurrenceClass() {\n    var rule = this.invoke(\"getField\", \"recurrenceRule\", this.rawAppointment);\n\n    if (getRecurrenceProcessor().isValidRecurrenceRule(rule)) {\n      this.$element().addClass(RECURRENCE_APPOINTMENT_CLASS);\n    }\n  }\n\n  _renderDirection() {\n    this.$element().addClass(DIRECTION_APPOINTMENT_CLASSES[this.option(\"direction\")]);\n  }\n\n  _createResizingConfig() {\n    var config = \"vertical\" === this.option(\"direction\") ? this._getVerticalResizingRule() : this._getHorizontalResizingRule();\n\n    if (!this.invoke(\"isGroupedByDate\")) {\n      config.stepPrecision = \"strict\";\n    }\n\n    return config;\n  }\n\n  _renderResizable() {\n    if (this.option(\"allowResize\")) {\n      this._createComponent(this.$element(), Resizable, extend(this._createResizingConfig(), this.option(\"resizableConfig\")));\n    }\n  }\n\n  _useTemplates() {\n    return false;\n  }\n\n}\nregisterComponent(\"dxSchedulerAppointment\", Appointment);\nexport class AgendaAppointment extends Appointment {\n  get coloredElement() {\n    return this.$element().find(\".\".concat(APPOINTMENT_CONTENT_CLASSES.AGENDA_MARKER));\n  }\n\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      createPlainResourceListAsync: new Deferred()\n    });\n  }\n\n  _renderResourceList(container, list) {\n    list.forEach(item => {\n      var itemContainer = $(\"<div>\").addClass(APPOINTMENT_CONTENT_CLASSES.AGENDA_RESOURCE_LIST_ITEM).appendTo(container);\n      $(\"<div>\").text(\"\".concat(item.label, \":\")).appendTo(itemContainer);\n      $(\"<div>\").addClass(APPOINTMENT_CONTENT_CLASSES.AGENDA_RESOURCE_LIST_ITEM_VALUE).text(item.values.join(\", \")).appendTo(itemContainer);\n    });\n  }\n\n  _render() {\n    super._render();\n\n    var createPlainResourceListAsync = this.option(\"createPlainResourceListAsync\");\n    createPlainResourceListAsync(this.rawAppointment).done(list => {\n      var parent = this.$element().find(\".\".concat(APPOINTMENT_CONTENT_CLASSES.APPOINTMENT_CONTENT_DETAILS));\n      var container = $(\"<div>\").addClass(APPOINTMENT_CONTENT_CLASSES.AGENDA_RESOURCE_LIST).appendTo(parent);\n\n      this._renderResourceList(container, list);\n    });\n  }\n\n}","map":{"version":3,"sources":["/home/igor/node_modules/devextreme/esm/ui/scheduler/appointments/appointment.js"],"names":["$","eventsEngine","move","getRecurrenceProcessor","extend","registerComponent","hide","show","addNamespace","pointerEvents","DOMComponent","Resizable","messageLocalization","dateLocalization","EMPTY_APPOINTMENT_CLASS","RECURRENCE_APPOINTMENT_CLASS","REDUCED_APPOINTMENT_CLASS","ALL_DAY_APPOINTMENT_CLASS","REDUCED_APPOINTMENT_ICON","REDUCED_APPOINTMENT_PARTS_CLASSES","DIRECTION_APPOINTMENT_CLASSES","APPOINTMENT_DRAG_SOURCE_CLASS","APPOINTMENT_CONTENT_CLASSES","Deferred","DEFAULT_HORIZONTAL_HANDLES","DEFAULT_VERTICAL_HANDLES","REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME","enter","REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME","leave","Appointment","coloredElement","$element","rawAppointment","option","_getDefaultOptions","data","groupIndex","geometry","top","left","width","height","allowDrag","allowResize","reduced","isCompact","direction","resizableConfig","cellHeight","cellWidth","isDragSource","notifyObserver","subject","args","observer","fire","invoke","apply","arguments","_optionChanged","name","_invalidate","_renderDragSourceClass","_getHorizontalResizingRule","reducedHandles","head","body","tail","handles","minHeight","minWidth","step","roundStepValue","_getVerticalResizingRule","_render","_renderAppointmentGeometry","_renderEmptyClass","_renderReducedAppointment","_renderAllDayClass","_renderDirection","attr","_renderRecurrenceClass","_renderResizable","_setResourceColor","deferredColor","itemData","done","color","css","empty","addClass","reducedPart","toggleClass","_renderAppointmentReducedIcon","$icon","appendTo","endDate","_getEndDate","tooltipLabel","format","tooltipText","join","off","on","target","content","result","Date","rule","isValidRecurrenceRule","_createResizingConfig","config","stepPrecision","_createComponent","_useTemplates","AgendaAppointment","find","concat","AGENDA_MARKER","createPlainResourceListAsync","_renderResourceList","container","list","forEach","item","itemContainer","AGENDA_RESOURCE_LIST_ITEM","text","label","AGENDA_RESOURCE_LIST_ITEM_VALUE","values","parent","APPOINTMENT_CONTENT_DETAILS","AGENDA_RESOURCE_LIST"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAc,wBAAd;AACA,OAAOC,YAAP,MAAyB,oCAAzB;AACA,SACIC,IADJ,QAEO,+BAFP;AAGA,SACIC,sBADJ,QAEO,eAFP;AAGA,SACIC,MADJ,QAEO,4BAFP;AAGA,OAAOC,iBAAP,MAA8B,qCAA9B;AACA,SACIC,IADJ,EAEIC,IAFJ,QAGO,0BAHP;AAIA,SACIC,YADJ,QAEO,6BAFP;AAGA,OAAOC,aAAP,MAA0B,yBAA1B;AACA,OAAOC,YAAP,MAAyB,6BAAzB;AACA,OAAOC,SAAP,MAAsB,iBAAtB;AACA,OAAOC,mBAAP,MAAgC,+BAAhC;AACA,OAAOC,gBAAP,MAA6B,4BAA7B;AACA,SACIC,uBADJ,EAEIC,4BAFJ,EAGIC,yBAHJ,EAIIC,yBAJJ,EAKIC,wBALJ,EAMIC,iCANJ,EAOIC,6BAPJ,EAQIC,6BARJ,EASIC,2BATJ,QAUO,cAVP;AAWA,SACIC,QADJ,QAEO,8BAFP;AAGA,IAAIC,0BAA0B,GAAG,YAAjC;AACA,IAAIC,wBAAwB,GAAG,YAA/B;AACA,IAAIC,2CAA2C,GAAGlB,YAAY,CAACC,aAAa,CAACkB,KAAf,EAAsB,wBAAtB,CAA9D;AACA,IAAIC,2CAA2C,GAAGpB,YAAY,CAACC,aAAa,CAACoB,KAAf,EAAsB,wBAAtB,CAA9D;AACA,OAAO,MAAMC,WAAN,SAA0BpB,YAA1B,CAAuC;AACxB,MAAdqB,cAAc,GAAG;AACjB,WAAO,KAAKC,QAAL,EAAP;AACH;;AACiB,MAAdC,cAAc,GAAG;AACjB,WAAO,KAAKC,MAAL,CAAY,MAAZ,CAAP;AACH;;AACDC,EAAAA,kBAAkB,GAAG;AACjB,WAAO/B,MAAM,CAAC,MAAM+B,kBAAN,EAAD,EAA6B;AACtCC,MAAAA,IAAI,EAAE,EADgC;AAEtCC,MAAAA,UAAU,EAAE,CAAC,CAFyB;AAGtCC,MAAAA,QAAQ,EAAE;AACNC,QAAAA,GAAG,EAAE,CADC;AAENC,QAAAA,IAAI,EAAE,CAFA;AAGNC,QAAAA,KAAK,EAAE,CAHD;AAINC,QAAAA,MAAM,EAAE;AAJF,OAH4B;AAStCC,MAAAA,SAAS,EAAE,IAT2B;AAUtCC,MAAAA,WAAW,EAAE,IAVyB;AAWtCC,MAAAA,OAAO,EAAE,IAX6B;AAYtCC,MAAAA,SAAS,EAAE,KAZ2B;AAatCC,MAAAA,SAAS,EAAE,UAb2B;AActCC,MAAAA,eAAe,EAAE,EAdqB;AAetCC,MAAAA,UAAU,EAAE,CAf0B;AAgBtCC,MAAAA,SAAS,EAAE,CAhB2B;AAiBtCC,MAAAA,YAAY,EAAE;AAjBwB,KAA7B,CAAb;AAmBH;;AACDC,EAAAA,cAAc,CAACC,OAAD,EAAUC,IAAV,EAAgB;AAC1B,QAAIC,QAAQ,GAAG,KAAKrB,MAAL,CAAY,UAAZ,CAAf;;AACA,QAAIqB,QAAJ,EAAc;AACVA,MAAAA,QAAQ,CAACC,IAAT,CAAcH,OAAd,EAAuBC,IAAvB;AACH;AACJ;;AACDG,EAAAA,MAAM,GAAG;AACL,QAAIF,QAAQ,GAAG,KAAKrB,MAAL,CAAY,UAAZ,CAAf;;AACA,QAAIqB,QAAJ,EAAc;AACV,aAAOA,QAAQ,CAACC,IAAT,CAAcE,KAAd,CAAoBH,QAApB,EAA8BI,SAA9B,CAAP;AACH;AACJ;;AACDC,EAAAA,cAAc,CAACN,IAAD,EAAO;AACjB,YAAQA,IAAI,CAACO,IAAb;AACI,WAAK,MAAL;AACA,WAAK,YAAL;AACA,WAAK,UAAL;AACA,WAAK,WAAL;AACA,WAAK,aAAL;AACA,WAAK,SAAL;AACA,WAAK,aAAL;AACA,WAAK,WAAL;AACA,WAAK,WAAL;AACA,WAAK,iBAAL;AACA,WAAK,YAAL;AACA,WAAK,WAAL;AACI,aAAKC,WAAL;;AACA;;AACJ,WAAK,cAAL;AACI,aAAKC,sBAAL;;AACA;;AACJ;AACI,cAAMH,cAAN,CAAqBN,IAArB;;AAnBR;AAqBH;;AACDU,EAAAA,0BAA0B,GAAG;AACzB,QAAIC,cAAc,GAAG;AACjBC,MAAAA,IAAI,EAAE,KAAKhC,MAAL,CAAY,YAAZ,IAA4B,OAA5B,GAAsC,MAD3B;AAEjBiC,MAAAA,IAAI,EAAE,EAFW;AAGjBC,MAAAA,IAAI,EAAE,KAAKlC,MAAL,CAAY,YAAZ,IAA4B,MAA5B,GAAqC;AAH1B,KAArB;AAKA,WAAO;AACHmC,MAAAA,OAAO,EAAE,KAAKnC,MAAL,CAAY,SAAZ,IAAyB+B,cAAc,CAAC,KAAK/B,MAAL,CAAY,SAAZ,CAAD,CAAvC,GAAkEV,0BADxE;AAEH8C,MAAAA,SAAS,EAAE,CAFR;AAGHC,MAAAA,QAAQ,EAAE,KAAKd,MAAL,CAAY,cAAZ,CAHP;AAIHe,MAAAA,IAAI,EAAE,KAAKf,MAAL,CAAY,kBAAZ,CAJH;AAKHgB,MAAAA,cAAc,EAAE;AALb,KAAP;AAOH;;AACDC,EAAAA,wBAAwB,GAAG;AACvB,QAAIhC,MAAM,GAAG,KAAKe,MAAL,CAAY,eAAZ,CAAb;AACA,WAAO;AACHY,MAAAA,OAAO,EAAE5C,wBADN;AAEH8C,MAAAA,QAAQ,EAAE,CAFP;AAGHD,MAAAA,SAAS,EAAE5B,MAHR;AAIH8B,MAAAA,IAAI,EAAE9B,MAJH;AAKH+B,MAAAA,cAAc,EAAE;AALb,KAAP;AAOH;;AACDE,EAAAA,OAAO,GAAG;AACN,UAAMA,OAAN;;AACA,SAAKC,0BAAL;;AACA,SAAKC,iBAAL;;AACA,SAAKC,yBAAL;;AACA,SAAKC,kBAAL;;AACA,SAAKhB,sBAAL;;AACA,SAAKiB,gBAAL;;AACA,SAAKhD,QAAL,GAAgBI,IAAhB,CAAqB,wBAArB,EAA+C,KAAKF,MAAL,CAAY,WAAZ,CAA/C;AACA,SAAKF,QAAL,GAAgBiD,IAAhB,CAAqB,OAArB,EAA8B,KAAKxB,MAAL,CAAY,UAAZ,EAAwB,MAAxB,EAAgC,KAAKxB,cAArC,CAA9B;AACA,SAAKD,QAAL,GAAgBiD,IAAhB,CAAqB,MAArB,EAA6B,QAA7B;;AACA,SAAKC,sBAAL;;AACA,SAAKC,gBAAL;;AACA,SAAKC,iBAAL;AACH;;AACDA,EAAAA,iBAAiB,GAAG;AAChB,QAAIC,aAAa,GAAG,KAAK5B,MAAL,CAAY,qBAAZ,EAAmC;AACnD6B,MAAAA,QAAQ,EAAE,KAAKrD,cADoC;AAEnDI,MAAAA,UAAU,EAAE,KAAKH,MAAL,CAAY,YAAZ;AAFuC,KAAnC,CAApB;AAIAmD,IAAAA,aAAa,CAACE,IAAd,CAAmBC,KAAK,IAAIA,KAAK,IAAI,KAAKzD,cAAL,CAAoB0D,GAApB,CAAwB,iBAAxB,EAA2CD,KAA3C,CAArC;AACH;;AACDZ,EAAAA,0BAA0B,GAAG;AACzB,QAAItC,QAAQ,GAAG,KAAKJ,MAAL,CAAY,UAAZ,CAAf;AACA,QAAIF,QAAQ,GAAG,KAAKA,QAAL,EAAf;AACA9B,IAAAA,IAAI,CAAC8B,QAAD,EAAW;AACXO,MAAAA,GAAG,EAAED,QAAQ,CAACC,GADH;AAEXC,MAAAA,IAAI,EAAEF,QAAQ,CAACE;AAFJ,KAAX,CAAJ;AAIAR,IAAAA,QAAQ,CAACyD,GAAT,CAAa;AACThD,MAAAA,KAAK,EAAEH,QAAQ,CAACG,KAAT,GAAiB,CAAjB,GAAqB,CAArB,GAAyBH,QAAQ,CAACG,KADhC;AAETC,MAAAA,MAAM,EAAEJ,QAAQ,CAACI,MAAT,GAAkB,CAAlB,GAAsB,CAAtB,GAA0BJ,QAAQ,CAACI;AAFlC,KAAb;AAIH;;AACDmC,EAAAA,iBAAiB,GAAG;AAChB,QAAIvC,QAAQ,GAAG,KAAKJ,MAAL,CAAY,UAAZ,CAAf;;AACA,QAAII,QAAQ,CAACoD,KAAT,IAAkB,KAAKxD,MAAL,CAAY,WAAZ,CAAtB,EAAgD;AAC5C,WAAKF,QAAL,GAAgB2D,QAAhB,CAAyB7E,uBAAzB;AACH;AACJ;;AACDgE,EAAAA,yBAAyB,GAAG;AACxB,QAAIc,WAAW,GAAG,KAAK1D,MAAL,CAAY,SAAZ,CAAlB;;AACA,QAAI,CAAC0D,WAAL,EAAkB;AACd;AACH;;AACD,SAAK5D,QAAL,GAAgB6D,WAAhB,CAA4B7E,yBAA5B,EAAuD,IAAvD,EAA6D6E,WAA7D,CAAyE1E,iCAAiC,CAACyE,WAAD,CAA1G,EAAyH,IAAzH;;AACA,SAAKE,6BAAL;AACH;;AACDA,EAAAA,6BAA6B,GAAG;AAC5B,QAAIC,KAAK,GAAG/F,CAAC,CAAC,OAAD,CAAD,CAAW2F,QAAX,CAAoBzE,wBAApB,EAA8C8E,QAA9C,CAAuD,KAAKhE,QAAL,EAAvD,CAAZ;;AACA,QAAIiE,OAAO,GAAG,KAAKC,WAAL,EAAd;;AACA,QAAIC,YAAY,GAAGvF,mBAAmB,CAACwF,MAApB,CAA2B,gCAA3B,CAAnB;AACA,QAAIC,WAAW,GAAG,CAACF,YAAD,EAAe,IAAf,EAAqBtF,gBAAgB,CAACuF,MAAjB,CAAwBH,OAAxB,EAAiC,aAAjC,CAArB,EAAsE,IAAtE,EAA4EpF,gBAAgB,CAACuF,MAAjB,CAAwBH,OAAxB,EAAiC,MAAjC,CAA5E,EAAsHK,IAAtH,CAA2H,EAA3H,CAAlB;AACArG,IAAAA,YAAY,CAACsG,GAAb,CAAiBR,KAAjB,EAAwBrE,2CAAxB;AACAzB,IAAAA,YAAY,CAACuG,EAAb,CAAgBT,KAAhB,EAAuBrE,2CAAvB,EAAqE,YAAW;AAC5EnB,MAAAA,IAAI,CAAC;AACDkG,QAAAA,MAAM,EAAEV,KADP;AAEDW,QAAAA,OAAO,EAAEL;AAFR,OAAD,CAAJ;AAIH,KALD;AAMApG,IAAAA,YAAY,CAACsG,GAAb,CAAiBR,KAAjB,EAAwBnE,2CAAxB;AACA3B,IAAAA,YAAY,CAACuG,EAAb,CAAgBT,KAAhB,EAAuBnE,2CAAvB,EAAqE,YAAW;AAC5EtB,MAAAA,IAAI;AACP,KAFD;AAGH;;AACD4F,EAAAA,WAAW,GAAG;AACV,QAAIS,MAAM,GAAG,KAAKlD,MAAL,CAAY,UAAZ,EAAwB,SAAxB,EAAmC,KAAKxB,cAAxC,CAAb;;AACA,QAAI0E,MAAJ,EAAY;AACR,aAAO,IAAIC,IAAJ,CAASD,MAAT,CAAP;AACH;;AACD,WAAOA,MAAP;AACH;;AACD5B,EAAAA,kBAAkB,GAAG;AACjB,SAAK/C,QAAL,GAAgB6D,WAAhB,CAA4B5E,yBAA5B,EAAuD,CAAC,CAAC,KAAKiB,MAAL,CAAY,QAAZ,CAAzD;AACH;;AACD6B,EAAAA,sBAAsB,GAAG;AACrB,SAAK/B,QAAL,GAAgB6D,WAAhB,CAA4BxE,6BAA5B,EAA2D,CAAC,CAAC,KAAKa,MAAL,CAAY,cAAZ,CAA7D;AACH;;AACDgD,EAAAA,sBAAsB,GAAG;AACrB,QAAI2B,IAAI,GAAG,KAAKpD,MAAL,CAAY,UAAZ,EAAwB,gBAAxB,EAA0C,KAAKxB,cAA/C,CAAX;;AACA,QAAI9B,sBAAsB,GAAG2G,qBAAzB,CAA+CD,IAA/C,CAAJ,EAA0D;AACtD,WAAK7E,QAAL,GAAgB2D,QAAhB,CAAyB5E,4BAAzB;AACH;AACJ;;AACDiE,EAAAA,gBAAgB,GAAG;AACf,SAAKhD,QAAL,GAAgB2D,QAAhB,CAAyBvE,6BAA6B,CAAC,KAAKc,MAAL,CAAY,WAAZ,CAAD,CAAtD;AACH;;AACD6E,EAAAA,qBAAqB,GAAG;AACpB,QAAIC,MAAM,GAAG,eAAe,KAAK9E,MAAL,CAAY,WAAZ,CAAf,GAA0C,KAAKwC,wBAAL,EAA1C,GAA4E,KAAKV,0BAAL,EAAzF;;AACA,QAAI,CAAC,KAAKP,MAAL,CAAY,iBAAZ,CAAL,EAAqC;AACjCuD,MAAAA,MAAM,CAACC,aAAP,GAAuB,QAAvB;AACH;;AACD,WAAOD,MAAP;AACH;;AACD7B,EAAAA,gBAAgB,GAAG;AACf,QAAI,KAAKjD,MAAL,CAAY,aAAZ,CAAJ,EAAgC;AAC5B,WAAKgF,gBAAL,CAAsB,KAAKlF,QAAL,EAAtB,EAAuCrB,SAAvC,EAAkDP,MAAM,CAAC,KAAK2G,qBAAL,EAAD,EAA+B,KAAK7E,MAAL,CAAY,iBAAZ,CAA/B,CAAxD;AACH;AACJ;;AACDiF,EAAAA,aAAa,GAAG;AACZ,WAAO,KAAP;AACH;;AA5LyC;AA8L9C9G,iBAAiB,CAAC,wBAAD,EAA2ByB,WAA3B,CAAjB;AACA,OAAO,MAAMsF,iBAAN,SAAgCtF,WAAhC,CAA4C;AAC7B,MAAdC,cAAc,GAAG;AACjB,WAAO,KAAKC,QAAL,GAAgBqF,IAAhB,CAAqB,IAAIC,MAAJ,CAAWhG,2BAA2B,CAACiG,aAAvC,CAArB,CAAP;AACH;;AACDpF,EAAAA,kBAAkB,GAAG;AACjB,WAAO/B,MAAM,CAAC,MAAM+B,kBAAN,EAAD,EAA6B;AACtCqF,MAAAA,4BAA4B,EAAE,IAAIjG,QAAJ;AADQ,KAA7B,CAAb;AAGH;;AACDkG,EAAAA,mBAAmB,CAACC,SAAD,EAAYC,IAAZ,EAAkB;AACjCA,IAAAA,IAAI,CAACC,OAAL,CAAaC,IAAI,IAAI;AACjB,UAAIC,aAAa,GAAG9H,CAAC,CAAC,OAAD,CAAD,CAAW2F,QAAX,CAAoBrE,2BAA2B,CAACyG,yBAAhD,EAA2E/B,QAA3E,CAAoF0B,SAApF,CAApB;AACA1H,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAWgI,IAAX,CAAgB,GAAGV,MAAH,CAAUO,IAAI,CAACI,KAAf,EAAsB,GAAtB,CAAhB,EAA4CjC,QAA5C,CAAqD8B,aAArD;AACA9H,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAW2F,QAAX,CAAoBrE,2BAA2B,CAAC4G,+BAAhD,EAAiFF,IAAjF,CAAsFH,IAAI,CAACM,MAAL,CAAY7B,IAAZ,CAAiB,IAAjB,CAAtF,EAA8GN,QAA9G,CAAuH8B,aAAvH;AACH,KAJD;AAKH;;AACDnD,EAAAA,OAAO,GAAG;AACN,UAAMA,OAAN;;AACA,QAAI6C,4BAA4B,GAAG,KAAKtF,MAAL,CAAY,8BAAZ,CAAnC;AACAsF,IAAAA,4BAA4B,CAAC,KAAKvF,cAAN,CAA5B,CAAkDsD,IAAlD,CAAuDoC,IAAI,IAAI;AAC3D,UAAIS,MAAM,GAAG,KAAKpG,QAAL,GAAgBqF,IAAhB,CAAqB,IAAIC,MAAJ,CAAWhG,2BAA2B,CAAC+G,2BAAvC,CAArB,CAAb;AACA,UAAIX,SAAS,GAAG1H,CAAC,CAAC,OAAD,CAAD,CAAW2F,QAAX,CAAoBrE,2BAA2B,CAACgH,oBAAhD,EAAsEtC,QAAtE,CAA+EoC,MAA/E,CAAhB;;AACA,WAAKX,mBAAL,CAAyBC,SAAzB,EAAoCC,IAApC;AACH,KAJD;AAKH;;AAxB8C","sourcesContent":["/**\r\n * DevExtreme (esm/ui/scheduler/appointments/appointment.js)\r\n * Version: 21.1.6\r\n * Build date: Mon Sep 27 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../../core/renderer\";\r\nimport eventsEngine from \"../../../events/core/events_engine\";\r\nimport {\r\n    move\r\n} from \"../../../animation/translator\";\r\nimport {\r\n    getRecurrenceProcessor\r\n} from \"../recurrence\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport registerComponent from \"../../../core/component_registrator\";\r\nimport {\r\n    hide,\r\n    show\r\n} from \"../../tooltip/ui.tooltip\";\r\nimport {\r\n    addNamespace\r\n} from \"../../../events/utils/index\";\r\nimport pointerEvents from \"../../../events/pointer\";\r\nimport DOMComponent from \"../../../core/dom_component\";\r\nimport Resizable from \"../../resizable\";\r\nimport messageLocalization from \"../../../localization/message\";\r\nimport dateLocalization from \"../../../localization/date\";\r\nimport {\r\n    EMPTY_APPOINTMENT_CLASS,\r\n    RECURRENCE_APPOINTMENT_CLASS,\r\n    REDUCED_APPOINTMENT_CLASS,\r\n    ALL_DAY_APPOINTMENT_CLASS,\r\n    REDUCED_APPOINTMENT_ICON,\r\n    REDUCED_APPOINTMENT_PARTS_CLASSES,\r\n    DIRECTION_APPOINTMENT_CLASSES,\r\n    APPOINTMENT_DRAG_SOURCE_CLASS,\r\n    APPOINTMENT_CONTENT_CLASSES\r\n} from \"../constants\";\r\nimport {\r\n    Deferred\r\n} from \"../../../core/utils/deferred\";\r\nvar DEFAULT_HORIZONTAL_HANDLES = \"left right\";\r\nvar DEFAULT_VERTICAL_HANDLES = \"top bottom\";\r\nvar REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME = addNamespace(pointerEvents.enter, \"dxSchedulerAppointment\");\r\nvar REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME = addNamespace(pointerEvents.leave, \"dxSchedulerAppointment\");\r\nexport class Appointment extends DOMComponent {\r\n    get coloredElement() {\r\n        return this.$element()\r\n    }\r\n    get rawAppointment() {\r\n        return this.option(\"data\")\r\n    }\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            data: {},\r\n            groupIndex: -1,\r\n            geometry: {\r\n                top: 0,\r\n                left: 0,\r\n                width: 0,\r\n                height: 0\r\n            },\r\n            allowDrag: true,\r\n            allowResize: true,\r\n            reduced: null,\r\n            isCompact: false,\r\n            direction: \"vertical\",\r\n            resizableConfig: {},\r\n            cellHeight: 0,\r\n            cellWidth: 0,\r\n            isDragSource: false\r\n        })\r\n    }\r\n    notifyObserver(subject, args) {\r\n        var observer = this.option(\"observer\");\r\n        if (observer) {\r\n            observer.fire(subject, args)\r\n        }\r\n    }\r\n    invoke() {\r\n        var observer = this.option(\"observer\");\r\n        if (observer) {\r\n            return observer.fire.apply(observer, arguments)\r\n        }\r\n    }\r\n    _optionChanged(args) {\r\n        switch (args.name) {\r\n            case \"data\":\r\n            case \"groupIndex\":\r\n            case \"geometry\":\r\n            case \"allowDrag\":\r\n            case \"allowResize\":\r\n            case \"reduced\":\r\n            case \"sortedIndex\":\r\n            case \"isCompact\":\r\n            case \"direction\":\r\n            case \"resizableConfig\":\r\n            case \"cellHeight\":\r\n            case \"cellWidth\":\r\n                this._invalidate();\r\n                break;\r\n            case \"isDragSource\":\r\n                this._renderDragSourceClass();\r\n                break;\r\n            default:\r\n                super._optionChanged(args)\r\n        }\r\n    }\r\n    _getHorizontalResizingRule() {\r\n        var reducedHandles = {\r\n            head: this.option(\"rtlEnabled\") ? \"right\" : \"left\",\r\n            body: \"\",\r\n            tail: this.option(\"rtlEnabled\") ? \"left\" : \"right\"\r\n        };\r\n        return {\r\n            handles: this.option(\"reduced\") ? reducedHandles[this.option(\"reduced\")] : DEFAULT_HORIZONTAL_HANDLES,\r\n            minHeight: 0,\r\n            minWidth: this.invoke(\"getCellWidth\"),\r\n            step: this.invoke(\"getResizableStep\"),\r\n            roundStepValue: false\r\n        }\r\n    }\r\n    _getVerticalResizingRule() {\r\n        var height = this.invoke(\"getCellHeight\");\r\n        return {\r\n            handles: DEFAULT_VERTICAL_HANDLES,\r\n            minWidth: 0,\r\n            minHeight: height,\r\n            step: height,\r\n            roundStepValue: true\r\n        }\r\n    }\r\n    _render() {\r\n        super._render();\r\n        this._renderAppointmentGeometry();\r\n        this._renderEmptyClass();\r\n        this._renderReducedAppointment();\r\n        this._renderAllDayClass();\r\n        this._renderDragSourceClass();\r\n        this._renderDirection();\r\n        this.$element().data(\"dxAppointmentStartDate\", this.option(\"startDate\"));\r\n        this.$element().attr(\"title\", this.invoke(\"getField\", \"text\", this.rawAppointment));\r\n        this.$element().attr(\"role\", \"button\");\r\n        this._renderRecurrenceClass();\r\n        this._renderResizable();\r\n        this._setResourceColor()\r\n    }\r\n    _setResourceColor() {\r\n        var deferredColor = this.invoke(\"getAppointmentColor\", {\r\n            itemData: this.rawAppointment,\r\n            groupIndex: this.option(\"groupIndex\")\r\n        });\r\n        deferredColor.done(color => color && this.coloredElement.css(\"backgroundColor\", color))\r\n    }\r\n    _renderAppointmentGeometry() {\r\n        var geometry = this.option(\"geometry\");\r\n        var $element = this.$element();\r\n        move($element, {\r\n            top: geometry.top,\r\n            left: geometry.left\r\n        });\r\n        $element.css({\r\n            width: geometry.width < 0 ? 0 : geometry.width,\r\n            height: geometry.height < 0 ? 0 : geometry.height\r\n        })\r\n    }\r\n    _renderEmptyClass() {\r\n        var geometry = this.option(\"geometry\");\r\n        if (geometry.empty || this.option(\"isCompact\")) {\r\n            this.$element().addClass(EMPTY_APPOINTMENT_CLASS)\r\n        }\r\n    }\r\n    _renderReducedAppointment() {\r\n        var reducedPart = this.option(\"reduced\");\r\n        if (!reducedPart) {\r\n            return\r\n        }\r\n        this.$element().toggleClass(REDUCED_APPOINTMENT_CLASS, true).toggleClass(REDUCED_APPOINTMENT_PARTS_CLASSES[reducedPart], true);\r\n        this._renderAppointmentReducedIcon()\r\n    }\r\n    _renderAppointmentReducedIcon() {\r\n        var $icon = $(\"<div>\").addClass(REDUCED_APPOINTMENT_ICON).appendTo(this.$element());\r\n        var endDate = this._getEndDate();\r\n        var tooltipLabel = messageLocalization.format(\"dxScheduler-editorLabelEndDate\");\r\n        var tooltipText = [tooltipLabel, \": \", dateLocalization.format(endDate, \"monthAndDay\"), \", \", dateLocalization.format(endDate, \"year\")].join(\"\");\r\n        eventsEngine.off($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME);\r\n        eventsEngine.on($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME, (function() {\r\n            show({\r\n                target: $icon,\r\n                content: tooltipText\r\n            })\r\n        }));\r\n        eventsEngine.off($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME);\r\n        eventsEngine.on($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME, (function() {\r\n            hide()\r\n        }))\r\n    }\r\n    _getEndDate() {\r\n        var result = this.invoke(\"getField\", \"endDate\", this.rawAppointment);\r\n        if (result) {\r\n            return new Date(result)\r\n        }\r\n        return result\r\n    }\r\n    _renderAllDayClass() {\r\n        this.$element().toggleClass(ALL_DAY_APPOINTMENT_CLASS, !!this.option(\"allDay\"))\r\n    }\r\n    _renderDragSourceClass() {\r\n        this.$element().toggleClass(APPOINTMENT_DRAG_SOURCE_CLASS, !!this.option(\"isDragSource\"))\r\n    }\r\n    _renderRecurrenceClass() {\r\n        var rule = this.invoke(\"getField\", \"recurrenceRule\", this.rawAppointment);\r\n        if (getRecurrenceProcessor().isValidRecurrenceRule(rule)) {\r\n            this.$element().addClass(RECURRENCE_APPOINTMENT_CLASS)\r\n        }\r\n    }\r\n    _renderDirection() {\r\n        this.$element().addClass(DIRECTION_APPOINTMENT_CLASSES[this.option(\"direction\")])\r\n    }\r\n    _createResizingConfig() {\r\n        var config = \"vertical\" === this.option(\"direction\") ? this._getVerticalResizingRule() : this._getHorizontalResizingRule();\r\n        if (!this.invoke(\"isGroupedByDate\")) {\r\n            config.stepPrecision = \"strict\"\r\n        }\r\n        return config\r\n    }\r\n    _renderResizable() {\r\n        if (this.option(\"allowResize\")) {\r\n            this._createComponent(this.$element(), Resizable, extend(this._createResizingConfig(), this.option(\"resizableConfig\")))\r\n        }\r\n    }\r\n    _useTemplates() {\r\n        return false\r\n    }\r\n}\r\nregisterComponent(\"dxSchedulerAppointment\", Appointment);\r\nexport class AgendaAppointment extends Appointment {\r\n    get coloredElement() {\r\n        return this.$element().find(\".\".concat(APPOINTMENT_CONTENT_CLASSES.AGENDA_MARKER))\r\n    }\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            createPlainResourceListAsync: new Deferred\r\n        })\r\n    }\r\n    _renderResourceList(container, list) {\r\n        list.forEach(item => {\r\n            var itemContainer = $(\"<div>\").addClass(APPOINTMENT_CONTENT_CLASSES.AGENDA_RESOURCE_LIST_ITEM).appendTo(container);\r\n            $(\"<div>\").text(\"\".concat(item.label, \":\")).appendTo(itemContainer);\r\n            $(\"<div>\").addClass(APPOINTMENT_CONTENT_CLASSES.AGENDA_RESOURCE_LIST_ITEM_VALUE).text(item.values.join(\", \")).appendTo(itemContainer)\r\n        })\r\n    }\r\n    _render() {\r\n        super._render();\r\n        var createPlainResourceListAsync = this.option(\"createPlainResourceListAsync\");\r\n        createPlainResourceListAsync(this.rawAppointment).done(list => {\r\n            var parent = this.$element().find(\".\".concat(APPOINTMENT_CONTENT_CLASSES.APPOINTMENT_CONTENT_DETAILS));\r\n            var container = $(\"<div>\").addClass(APPOINTMENT_CONTENT_CLASSES.AGENDA_RESOURCE_LIST).appendTo(parent);\r\n            this._renderResourceList(container, list)\r\n        })\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}